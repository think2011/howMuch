{"version":3,"sources":["Scene2.js"],"names":[],"mappings":"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","file":"Scene2-compiled.js","sourcesContent":["class Scene2 {\n    constructor() {\n        this.$container    = document.querySelector('#scene2')\n        this.$prices       = this.$container.querySelector('.prices')\n        this.$imgContainer = this.$container.querySelector('.img')\n\n        this.init()\n    }\n\n    init() {\n        this.$container.classList.add('slideInUp')\n        this.$container.classList.add('animated')\n        this.$container.style.display = 'block'\n\n        this.$prices.addEventListener('click', (event) => {\n            let $target = event.target\n\n            if ($target.tagName !== 'BUTTON') return\n\n            this.judge(+$target.dataset.price, $target)\n        })\n\n        this.start()\n    }\n\n    start() {\n        GAME_PARAMS.items.push(GAME_PARAMS.items.shift())\n        let item = GAME_PARAMS.items[0]\n\n        this.price = +(item.promoPrice || item.price)\n        this.count = 4\n        this.renderPrices(this.price)\n        this.renderGoods(item)\n    }\n\n    renderPrices(price) {\n        let prices = tools.createPrices(price)\n\n        this.$prices.innerHTML = ''\n        prices.forEach((item) => {\n            this.$prices.innerHTML += `\n        <li class=\"item animated\">\n            <button data-price=\"${item}\">${item}</button>\n        </li>`\n        })\n\n        this.judgeing = false\n    }\n\n    renderGoods(item) {\n        this.$imgContainer.innerHTML = `\n            <img src=\"${item.picUrl}_500x500.jpg_.webp\">\n            <div class=\"title\">${item.title}</div>\n`\n    }\n\n    judge(price, $target) {\n        if (this.judgeing) return\n\n        price = +price\n\n        this.judgeing = true\n        this.count--\n\n        let resultMap = {\n            ok  : ['flip', '😘 没错, 就是这个价!', 3000],\n            high: ['fadeIn', '😂 太贵了', 3000],\n            low : ['fadeIn', '😓 太便宜了', 3000]\n        }\n        let result    = price === this.price ? 'ok' : price > this.price ? 'high' : 'low'\n\n        if (result !== 'ok') {\n            $target.setAttribute('disabled', 'disabled')\n            $target.classList.add('disabled')\n        } else {\n            $target.classList.add('success')\n        }\n\n        $target.classList.add('animated')\n        $target.classList.add(resultMap[result][0])\n        tools.animationEvent($target, 'AnimationEnd', () => {\n            this.judgeing = false\n\n            if (result !== 'ok') {\n                $target.classList.remove(resultMap[result][0])\n                toast({content: `${resultMap[result][1]}`, time: resultMap[result][2]})\n            } else {\n                return this.gamePass()\n            }\n\n            if (this.count < 0) {\n                this.judgeing = true\n                setTimeout(() => this.gameOver(), 500)\n            }\n\n        })\n    }\n\n    gamePass() {\n        dialog.success({\n            content: '<div class=\"only-text\">恭喜您获得了抽奖机会!</div>',\n            btn1   : {\n                title: '马上抽奖',\n                click: () => {\n                    dialog.close()\n                    dialog.win(3, 100)\n                }\n            }\n        })\n    }\n\n    gameOver() {\n        dialog.fail({\n            btn1: {\n                title: '再来一次',\n                click: () => {\n                    dialog.close()\n                    this.start()\n                }\n            }\n        })\n    }\n}"]}